"use strict";(function(){jQuery(document).ready(function(d){var e,l=null!=(e=window.wc_memberships_admin)?e:{},u=function(e){return{type:e.split("|")[0],name:e.split("|")[1]}},h=function(e){var t={};switch(e.type){case"taxonomy":t.action="wc_memberships_json_search_terms",t.security=l.search_terms_nonce,t.taxonomy=e.name;break;case"post_type":t.action="product"===e.name?"woocommerce_json_search_products_and_variations":"wc_memberships_json_search_posts",t.security="product"===e.name?l.search_products_nonce:l.search_posts_nonce,t.post_type=e.name}return t},f=function(i){var n=0;return d("table."+i+"-rules tbody."+i+"-rule").each(function(e,t){if(!d(t).hasClass(i+"-rule-__INDEX__"))return d(t).removeClass(function(e,t){var s=new RegExp(i+"-rule-[0-9]","g"),n=t.match(s);if(n)return n[0]}),d(t).addClass(i+"-rule-"+n),d("input, select, textarea",t).each(function(e,t){var s=jQuery(t);if(s.attr("name"))return s.attr("name",s.attr("name").replace(/\[([^[]*)\]/,"["+n+"]"))}),n++})},t=function(e){var t,s=d(e).get(0).tagName,n="INPUT"===s?d('input[type="radio"][name="'+d(e).attr("name")+'"]:checked').val():d(e).val(),i=d(e).closest(".rule");if("immediate"===n){if(i.find(".js-show-if-access-schedule-immediate").removeClass("hide"),i.find(".js-hide-if-access-schedule-immediate").addClass("hide"),"SELECT"===s)return i.find(".js-access-schedule-period-selector").val(n).first().focus()}else if(i.find(".js-show-if-access-schedule-immediate").addClass("hide"),i.find(".js-hide-if-access-schedule-immediate").removeClass("hide"),"SELECT"!==s||d(e).hasClass("access_schedule-period")||i.find(".access_schedule-period").find("option").removeAttr("selected"),(t=i.find(".access_schedule-amount")).val()||t.val(1),d(e).hasClass("js-schedule-type"))return t.focus()};return l.initializeRuleset=function(r){var a=".js-object-ids",o=d("."+r+"-rules");return o.on("change",".js-content-type",function(e){var t=h(u(d(this).val())),s=d(this).closest("tr").find(a);return d(s).removeData("selected").val("").select2("destroy"),l.initializeEnhancedSelect(s,t)}),o.on("change",".js-access-schedule-period-selector",function(e){return t(this)}),o.find(a).each(function(){var e,t;if(!d(this).closest("tbody").hasClass(r+"-rule-__INDEX__"))return t=d(this).closest("tbody").find(".js-content-type").get(0).value,e=h(u(t)),l.initializeEnhancedSelect(this,e)}),o.find(".js-add-rule").click(function(){var e,t,s,n=o.find("."+r+"-rule-__INDEX__"),i=o.children("tbody").length-1,c=d(n.prop("outerHTML").replace(/__INDEX__/g,i));return n.before(c),(e=c.find("select.membership-plan"))&&e.select2(),c.find(".js-content-type").length&&(t=c.find(".js-content-type").get(0).value,s=h(u(t)),l.initializeEnhancedSelect(c.find(a),s)),o.find(".norules").addClass("hide"),o.find("tfoot .js-remove-rules").removeClass("hide"),f(r)}),o.find(".js-remove-rules").click(function(){var e=o.find('th.check-column input[type="checkbox"]:checked');return d.when(e.closest("tbody").fadeOut(400,function(){var e=d(this);return e.find(".js-rule-id").val()?e.addClass("hide").find(".js-rule-remove").val(1):setTimeout(function(){return e.remove()},1)})).then(function(){return o.find(".rule:visible").length<1&&(o.find(".norules").removeClass("hide"),o.find(".js-remove-rules").addClass("hide")),o.find('th.check-column input[type="checkbox"]').removeAttr("checked"),f(r)})})}})}).call(void 0);